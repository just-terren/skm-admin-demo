(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[661],{6800:function(e,t,a){Promise.resolve().then(a.bind(a,4872))},2750:function(e,t,a){"use strict";a.d(t,{m:function(){return n}});let n="S001"},3712:function(e,t,a){"use strict";async function n(e){let{query:t,headers:a={"Content-Type":"application/json"},body:n,mode:r="cors",...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=await fetch("".concat("https://skm-report-test-a70f647b267b.herokuapp.com").concat(e).concat(t?"?".concat(new URLSearchParams(Object.entries(t).reduce((e,t)=>{let[a,n]=t;return e[a]=n.toString(),e},{})).toString()):""),{...i,headers:a,body:n&&JSON.stringify(n),mode:r});return await l.json()}a.d(t,{r:function(){return n}})},4872:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var n=a(7437),r=a(2750),i=a(3712);async function l(e,t,a){return await (0,i.r)("/schedule/reports/query",{method:"POST",body:{...e,...t},signal:a})}var o=a(1991),s=a(8608),c=a(1032),d=a(9263),u=a(2067),g=a.n(u);function m(e){return e?g()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}var p=a(2265),b=a(6216);let f=[{title:"動作",render:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Z,{look:"link",onClick:()=>{},children:"編輯"})," ",(0,n.jsx)(o.Z,{look:"link",onClick:()=>{},children:"複製"})]})},{dataIndex:"name",title:"檔案名稱"},{dataIndex:"localPath",title:"本地路徑"},{dataIndex:"isEnable",title:"啟用",render:e=>e?"是":"否"},{dataIndex:"cronSchedule",title:"發送排程"},{dataIndex:"startDateTime",title:"起始時間",render:e=>m(e)},{dataIndex:"endDateTime",title:"結束時間",render:e=>m(e)}];var h=(0,p.memo)(function(){let{tableProps:e,search:{submit:t}}=(0,d.w)(async(e,t,a)=>{let{page:n,pageSize:i}=t,{code:o,data:s,currentPage:c,pageSize:d,totalPage:u}=await l(e,{pageNum:n,pageSize:i},a);return o===r.m?{items:s,page:c,pageSize:d,totalPages:u}:{items:[],page:1,pageSize:i,totalPages:0}});return(0,n.jsxs)("div",{className:"flex flex-col gap-12",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(b.l0,{onSubmit:e=>{t(e)},render:e=>{let{handleSubmit:t}=e;return(0,n.jsx)("form",{onSubmit:t,children:(0,n.jsx)(b.gN,{name:"name",render:e=>{let{input:{value:t,onChange:a}}=e;return(0,n.jsx)(s.Z,{placeholder:"Search",value:t,onChange:a})}})})}})}),(0,n.jsx)(o.Z,{look:"primary",onClick:()=>{},children:"新增"})]}),(0,n.jsx)(c.Z,{...e,rowKeyName:"no",columns:f})]})})},1991:function(e,t,a){"use strict";var n=a(7437),r=a(2744),i=a.n(r);let l=(0,a(2265).memo)(function(e){let{look:t="default",className:a,disabled:r,children:l,...o}=e;return(0,n.jsx)("button",{...o,className:i()({"rounded-md border bg-white px-3 py-1.5 hover:bg-slate-50 disabled:bg-gray-200 disabled:text-gray-400":"default"===t,"rounded-md border border-blue-600 bg-blue-600 px-3 py-1.5 text-white hover:bg-blue-700 disabled:border-blue-500 disabled:bg-blue-500 disabled:text-gray-300":"primary"===t,"text-blue-600 hover:text-blue-700 hover:underline disabled:text-gray-400 disabled:no-underline":"link"===t},a),disabled:r,children:l})});t.Z=l},8608:function(e,t,a){"use strict";var n=a(7437),r=a(2265);let i=(0,r.memo)((0,r.forwardRef)(function(e,t){let{...a}=e;return(0,n.jsx)("input",{...a,className:"rounded-md border px-3 py-1.5 focus-visible:outline focus-visible:outline-blue-400",ref:t})}));t.Z=i},791:function(e,t,a){"use strict";a.r(t);var n=a(7437),r=a(2265),i=a(1991),l=a(2744),o=a.n(l);let s=(0,r.memo)(function(e){let{active:t,className:a,...r}=e;return(0,n.jsx)(i.Z,{...r,className:o()("rounded-none border-0 !px-3 !py-1.5",{"!text-blue-600":t},a)})}),c=(0,r.memo)(function(e){return(0,n.jsx)(s,{...e,className:"disabled:!bg-white",disabled:!0,children:"..."})}),d=(0,r.memo)(function(e){let{className:t,page:a,pageSize:i,total:l,totalPages:d,onChange:u}=e,g=a,m=i;g<1&&(g=1,console.error("page must be greater than or equal to 1")),m<1&&(m=1,console.error("pageSize must be greater than or equal to 1"));let p=d?Math.max(d,1):Math.max(Math.ceil(l/m),1);g>p&&(g=p,console.error("page must be less than or equal to total pages"));let b=(0,r.useRef)(g);b.current=g;let f=(0,r.useRef)(m);f.current=m;let h=(0,r.useRef)(new Map),x=(0,r.useRef)(u);x.current=u;let v=(0,r.useCallback)(e=>{if(h.current.has(e))return h.current.get(e);{let t=()=>{if(b.current!==e){var t;null===(t=x.current)||void 0===t||t.call(x,e,f.current)}};return h.current.set(e,t),t}},[]),j=Math.max(g-1,2),w=Math.min(g+1,p-1);return(0,n.jsxs)("div",{className:o()("divide-x overflow-hidden rounded-md border",t),children:[(0,n.jsx)(s,{disabled:1===g,onClick:v(g-1),children:"<"}),(0,n.jsx)(s,{active:1===g,onClick:v(1),children:"1"}),j>2&&(0,n.jsx)(c,{}),Array.from({length:w-j+1},(e,t)=>t+j).map(e=>(0,n.jsx)(s,{active:g===e,onClick:v(e),children:e},e)),p-w>1&&(0,n.jsx)(c,{}),p>1&&(0,n.jsx)(s,{active:g===p,onClick:v(p),children:p}),(0,n.jsx)(s,{disabled:g===p,onClick:v(g+1),children:">"})]})});t.default=d},1032:function(e,t,a){"use strict";a.d(t,{Z:function(){return d}});var n=a(7437),r=a(2265),i=a(791),l=a(1872),o=a(2744),s=a.n(o);let c=(0,r.memo)(function(e){let{className:t,spinning:a=!1,size:r="10",expand:i,children:l}=e;return(0,n.jsxs)("div",{className:s()("relative inline-block",{"h-full w-full":i},t),children:[l,a&&(0,n.jsx)("div",{className:s()("flex items-center justify-center",{"absolute inset-0  bg-white opacity-70":l}),children:(0,n.jsx)("div",{className:s()("animate-spin rounded-full border-solid border-slate-100 border-t-blue-500",{"h-2.5 w-2.5 border-2":"2.5"===r,"h-10 w-10 border-4":"10"===r})})})]})});var d=(0,r.memo)(function(e){let{className:t,rowKeyName:a,columns:o,dataSource:s,loading:d,pagination:u,onChange:g}=e,m=(0,r.useMemo)(()=>o.map(e=>{var t,a;return[(null===(t=e.key)||void 0===t?void 0:t.toString())||(null===(a=e.dataIndex)||void 0===a?void 0:a.toString())||(0,l.Z)(),e]}),[o]),p=(0,r.useMemo)(()=>(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{className:"border-b border-slate-200",children:m.map(e=>{let[t,{title:a}]=e;return(0,n.jsx)("th",{className:"p-2 text-start",children:a},t)})})}),[m]),b=(0,r.useMemo)(()=>(0,n.jsx)("tbody",{children:null==s?void 0:s.map(e=>{var t;return(0,n.jsx)("tr",{className:"border-b border-slate-200",children:m.map(t=>{var a;let[r,{dataIndex:i,render:l}]=t;return(0,n.jsx)("td",{className:"p-2",children:l?l(i&&e[i],e):i&&(null===(a=e[i])||void 0===a?void 0:a.toString())},r)})},null===(t=e[a])||void 0===t?void 0:t.toString())})}),[s,m,a]),f=(0,r.useMemo)(()=>u&&{...u,onChange:g},[u,g]);return(0,n.jsx)(c,{className:t,spinning:d,expand:!0,children:(0,n.jsxs)("div",{className:"flex flex-col gap-12",children:[(0,n.jsx)("div",{className:"overflow-auto",children:(0,n.jsxs)("table",{className:"min-w-full border-collapse",children:[p,b]})}),f&&(0,n.jsx)(i.default,{...f,className:"self-center overflow-auto"})]})})})},9263:function(e,t,a){"use strict";a.d(t,{w:function(){return i}});var n=a(2265),r=a(6970);function i(e){let{manual:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{manual:!1},[a,i]=(0,r.x)({dataSource:[],pagination:{page:1,pageSize:20,total:0,totalPages:0},loading:!1}),l=(0,n.useRef)(new AbortController),o=(0,n.useCallback)(async(t,a)=>{l.current.abort();let n=new AbortController;l.current=n;let r=await e(t,a,n.signal);if(n.signal.aborted)throw new DOMException(void 0,"AbortError");return r},[e]),s=(0,n.useCallback)(async(e,t)=>{i(a=>{a.pagination.page=e,a.pagination.pageSize=t,a.loading=!0});try{let{items:n,page:r,pageSize:l,totalPages:s}=await o(a.filter,{page:e,pageSize:t});i(e=>{e.dataSource=n,e.pagination.page=r,e.pagination.pageSize=l,e.pagination.total=0,e.pagination.totalPages=s,e.loading=!1})}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)return;throw i(e=>{e.dataSource=[],e.pagination.page=1,e.pagination.total=0,e.pagination.totalPages=0,e.loading=!1}),e}},[o,a.filter,i]),c=(0,n.useMemo)(()=>({...a,onChange:s}),[a,s]),d=(0,n.useCallback)(async e=>{i(t=>{t.filter=e,t.pagination.page=1,t.loading=!0});try{let{items:t,page:n,totalPages:r}=await o(e,{page:1,pageSize:a.pagination.pageSize});i(e=>{e.dataSource=t,e.pagination.page=n,e.pagination.totalPages=r,e.loading=!1})}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)return;throw i(e=>{e.dataSource=[],e.pagination.page=1,e.pagination.total=0,e.pagination.totalPages=0,e.loading=!1}),e}},[o,i,a.pagination.pageSize]),u=(0,n.useRef)(d);u.current=d,(0,n.useEffect)(()=>{t||u.current()},[t]);let g=(0,n.useMemo)(()=>({submit:d}),[d]);return(0,n.useMemo)(()=>({tableProps:c,search:g}),[c,g])}}},function(e){e.O(0,[990,138,971,938,744],function(){return e(e.s=6800)}),_N_E=e.O()}]);